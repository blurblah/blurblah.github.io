<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Azure VM의 ssh connection refused 해결방법 | My Site</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://blurblah.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://blurblah.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://blurblah.github.io/2016/03/01/wp/azure-vm의-ssh-connection-refused-해결방법"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Azure VM의 ssh connection refused 해결방법 | My Site"><meta data-rh="true" name="description" content="MS Azure에서 Ubuntu VM을 생성해 사용하던 중에 어느 시점부터 ssh 연결이 되지 않는 경우가 생겼다."><meta data-rh="true" property="og:description" content="MS Azure에서 Ubuntu VM을 생성해 사용하던 중에 어느 시점부터 ssh 연결이 되지 않는 경우가 생겼다."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2016-03-01T00:00:00.000Z"><meta data-rh="true" property="article:tag" content="azure,disk-attach,reset-remote-access,ssh-connection-refused,troubleshooting,vm"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://blurblah.github.io/2016/03/01/wp/azure-vm의-ssh-connection-refused-해결방법"><link data-rh="true" rel="alternate" href="https://blurblah.github.io/2016/03/01/wp/azure-vm의-ssh-connection-refused-해결방법" hreflang="en"><link data-rh="true" rel="alternate" href="https://blurblah.github.io/2016/03/01/wp/azure-vm의-ssh-connection-refused-해결방법" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/rss.xml" title="My Site RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="My Site Atom Feed"><link rel="stylesheet" href="/assets/css/styles.87564fa0.css">
<script src="/assets/js/runtime~main.e36f3c5d.js" defer="defer"></script>
<script src="/assets/js/main.dfb2dcc2.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">My Site</b></a><a class="navbar__item navbar__link" href="/docs/intro">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/blurblah" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/2020/01/20/wp/kubernetes에서-특정-node에-pod가-배포되는-현상에-대한-분석">Kubernetes에서 특정 node에 pod가 배포되는 현상에 대한 분석</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/2018/08/14/wp/kubernetes-with-aws-api-gateway">Kubernetes with AWS API gateway</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/2018/06/09/wp/날씨-정보를-편하게-받아볼까-해서-시작한-일들">날씨 정보를 편하게 받아볼까 해서 시작한 일들</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/2018/05/27/wp/xiaomi-센서로-실내-온도를-측정해서-influxdb에-저장하고-grafana로-그">Xiaomi 센서로 실내 온도를 측정해서 InfluxDB에 저장하고 Grafana로 그린다</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/2018/05/17/wp/snmp를-통한-asus-공유기-모니터링-시작하기">SNMP를 통한 ASUS 공유기  모니터링 시작하기</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="https://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="MS Azure에서 Ubuntu VM을 생성해 사용하던 중에 어느 시점부터 ssh 연결이 되지 않는 경우가 생겼다."><header><h1 class="title_f1Hy" itemprop="headline">Azure VM의 ssh connection refused 해결방법</h1><div class="container_mt6G margin-vert--md"><time datetime="2016-03-01T00:00:00.000Z" itemprop="datePublished">March 1, 2016</time> · <!-- -->6 min read</div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p>MS Azure에서 Ubuntu VM을 생성해 사용하던 중에 어느 시점부터 ssh 연결이 되지 않는 경우가 생겼다.</p>
<p>Portal dashboard 상에서는 running 상태로 표시되고 있고 실제 DNS나 IP는 제대로 할당된 것으로 보였는데 ssh 접속을 시도하면 connection refused라고 표시되었는데 verbose option으로 메세지를 봐도 특별한 내용은 없었다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-reset-remote-access"><strong>1. Reset remote access</strong><a href="#1-reset-remote-access" class="hash-link" aria-label="Direct link to 1-reset-remote-access" title="Direct link to 1-reset-remote-access">​</a></h4>
<p>해결을 위해 Azure에서 제시하고 있는 방법은 아래 링크와 같다.</p>
<p><a href="https://azure.microsoft.com/en-us/documentation/articles/virtual-machines-troubleshoot-ssh-connections/" target="_blank" rel="noopener noreferrer">https://azure.microsoft.com/en-us/documentation/articles/virtual-machines-troubleshoot-ssh-connections/</a></p>
<p>가장 손쉬운 방법은 remote access를 reset하는 것인데 별 문제가 아니라면 이 기능으로 해결이 되는 것 같다.</p>
<p>예전 portal (<a href="https://manage.windowsazure.com" target="_blank" rel="noopener noreferrer">https://manage.windowsazure.com</a>)에서 VM dashboard를 보면 해당 기능에 대한 링크가 있고 누르면 새로운 portal로 이동해서 진행하도록 되어있다.</p>
<p><a href="https://blurblah.net/wp-content/uploads/2016/03/reset_remote_access.png" target="_blank" rel="noopener noreferrer"><img decoding="async" loading="lazy" alt="reset_remote_access" src="/assets/images/reset_remote_access-b1bb607ee3a2e282cb4ebdd8d4965f6b.png" width="498" height="112" class="img_ev3q"></a></p>
<p>대략 10분 이내에 reset이 되는데 이걸로 해결이 안된다면 아래의 방법을 참조한다.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-disk만-분리해서-문제해결-후-vm을-재생성하는-방법"><strong>2. Disk만 분리해서 문제해결 후 VM을 재생성하는 방법</strong><a href="#2-disk만-분리해서-문제해결-후-vm을-재생성하는-방법" class="hash-link" aria-label="Direct link to 2-disk만-분리해서-문제해결-후-vm을-재생성하는-방법" title="Direct link to 2-disk만-분리해서-문제해결-후-vm을-재생성하는-방법">​</a></h4>
<p>VM에 접속이 안되니 문제를 확인할 수도, 추측되는 문제의 원인을 해결할 수도 없다.</p>
<p>국내 IDC에 있거나 근처에 있는 장비라면 직접 가서 상태를 확인할 수도 있겠지만 클라우드라 그럴 수도 없다.</p>
<p>이 방법은 VM의 disk만 따로 떼어내서 원인 확인 및 해결 후에 다시 VM에 연결해서 살리는 방법이다.</p>
<p>참조한 링크문서는 아래와 같다.</p>
<p><a href="https://social.msdn.microsoft.com/Forums/en-US/54c600c0-f4d6-4b20-ad87-1358fa10d27a/linux-vm-ssh-connection-refused?forum=WAVirtualMachinesforWindows" target="_blank" rel="noopener noreferrer">https://social.msdn.microsoft.com/Forums/en-US/54c600c0-f4d6-4b20-ad87-1358fa10d27a/linux-vm-ssh-connection-refused?forum=WAVirtualMachinesforWindows</a></p>
<p><strong>(0) 사전에 유의할 내용</strong></p>
<p>Disk를 attach, detach 하거나 VM 삭제하면서 남겨둔 disk 정보가 리스트에 늦게 반영되는 경우가 있었다.</p>
<p>관련 작업을 하면서 disk가 보이지 않는다면 몇 분 정도 후에 다시 시도해보면 확인할 수 있다.</p>
<p>임시로 사용할 VM은 삭제하는 VM과 동일한 storage account를 사용하고 있어야 한다.</p>
<p>Disk는 storage account 별로 동일한 공간에 위치하기 때문이다. (물리적으로는 다른 영역일 수 있지만)</p>
<p><strong>(1) VM 삭제</strong></p>
<p>우선 VM을 삭제해야 하는데 삭제할 때 관련 disk는 남겨둔다. (select &quot;Keep the attached disks&quot;)</p>
<p>VM에 attach되어 있는 disk는 다른 VM에 붙일 수 없게 되어있기 때문이다.</p>
<p><strong>(2) 새로운(임시) VM에서 attach disk / mount</strong></p>
<p>새로운 VM을 생성하거나 이미 사용중인 VM에서 attach disk 버튼을 눌러 (1) 과정에서 남겨둔 disk를 붙여준다.</p>
<p><a href="https://blurblah.net/wp-content/uploads/2016/03/attach_disk.png" target="_blank" rel="noopener noreferrer"><img decoding="async" loading="lazy" alt="attach_disk" src="/assets/images/attach_disk-e8dd27bd509f2890dc4cd38b1e5aa7a1.png" width="601" height="179" class="img_ev3q"></a>정상적으로 붙었다면 dashboard에 표시되지만 임시 VM에서 확인하면 보이지 않는다.</p>
<p>하지만 /var/log/syslog를 SCSI로 grep을 해보면 새롭게 추가된 disk를 확인할 수 있다.</p>
<p><a href="https://blurblah.net/wp-content/uploads/2016/03/grep_scsi.png" target="_blank" rel="noopener noreferrer"><img decoding="async" loading="lazy" alt="grep_scsi" src="data:image/png;base64,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" width="646" height="45" class="img_ev3q"></a></p>
<p>일반적인 경우라면 /dev/sda1가 root filesystem으로 /dev/sdb1이 붙어있는 상태이고 신규로 추가한 disk는 sdc로 연결된다.</p>
<p>VM에서 mount할 임시 경로를 만들고 /dev/sdc1을 (sdc인 경우) 생성한 경로에 mount 해준다.</p>
<p>mount /dev/sdc1 mount_point</p>
<p><strong>(3) 문제 분석 / 해결</strong></p>
<p>위 과정까지 문제가 없었다면 ssh 연결이 되지 않던 VM의 disk 내용을 고스란히 볼 수 있다.</p>
<p>boot log나 syslog, dmesg 등을 mount 된 경로에서 확인하고 문제의 원인을 분석한다.</p>
<p>나의 경우에는 fstab에서 webdav로 mount 하고 있는 외부 disk 연결에 문제가 발생하는게 원인이었던 것으로 보여 fstab에서 그 부분을 주석처리 해버렸다.</p>
<p>(fstab에서 사용한 option을 좀 수정해야 하겠지만 우선은 VM을 살리는게 목적이었으니 그냥 진행)</p>
<p><strong>(4) Detach disk / VM 생성</strong></p>
<p>다시 booting을 해도 문제가 없을 것처럼 손을 봤으면 임시 VM에서 disk를 umount하고 portal dashboard에서도 detach 해준다.</p>
<p>그 이후에는 실제로 사용할 VM (과거에 제거한 VM과 동일하게 해도 문제없음. Cloud service만 같이 제거한 상태라면)을 생성하는데 detach된 disk를 가지고 생성해야 한다. (VM 생성시에 Gallery의 MY DISKS 항목에서 수정된 disk를 선택)</p>
<p>사전 유의사항에도 명시한 것처럼 disk list가 갱신되는데 시간이 좀 걸릴 수 있으니 list에 disk가 보이지 않으면 얼마 후에 다시 시도해야 한다.</p></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/azure">azure</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/disk-attach">disk-attach</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/reset-remote-access">reset-remote-access</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/ssh-connection-refused">ssh-connection-refused</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/troubleshooting">troubleshooting</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/vm">vm</a></li></ul></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/2016/03/16/wp/덕만이-잠든-시간에-tell-me-your-ip"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">덕만이 잠든 시간에 - Tell me your IP</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/2016/01/15/wp/덕만이-잠든-시간에-httpinputstream의-read와-fileoutputstream의-write-함수"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">덕만이 잠든 시간에 - HttpInputStream의 read와 FileOutputStream의 write 함수</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>